<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bait Check-In | Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary: #0ea5e9;
            --primary-dark: #0284c7;
            --primary-light: #7dd3fc;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --sidebar-bg: #0f172a;
            --sidebar-hover: #1e293b;
            --bg-main: #f1f5f9;
            --bg-card: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --border: #e2e8f0;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.12);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', sans-serif;
            background: var(--bg-main);
            min-height: 100vh;
            color: var(--text-primary);
        }

        /* Layout */
        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            color: white;
            padding: 24px 0;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
        }

        .logo {
            padding: 0 24px 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 24px;
        }

        .logo h1 {
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo h1 i {
            color: var(--primary);
        }

        .nav-menu {
            flex: 1;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 24px;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: var(--sidebar-hover);
            color: white;
        }

        .nav-item.active {
            background: var(--sidebar-hover);
            color: white;
            border-left-color: var(--primary);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }

        /* Team Badges */
        .team-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            color: white;
        }

        .team-badge.team-a { background: linear-gradient(135deg, #0ea5e9, #0284c7); }
        .team-badge.team-b { background: linear-gradient(135deg, #10b981, #059669); }
        .team-badge.team-c { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .team-badge.team-d { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .team-badge.team-e { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .team-badge.team-f { background: linear-gradient(135deg, #ec4899, #db2777); }
        .team-badge.team-g { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .team-badge.team-h { background: linear-gradient(135deg, #84cc16, #65a30d); }
        .team-badge.team-i { background: linear-gradient(135deg, #f97316, #ea580c); }
        .team-badge.team-j { background: linear-gradient(135deg, #6366f1, #4f46e5); }
        .team-badge.team-k { background: linear-gradient(135deg, #14b8a6, #0d9488); }
        .team-badge.team-l { background: linear-gradient(135deg, #a855f7, #9333ea); }
        .team-badge.team-m { background: linear-gradient(135deg, #f43f5e, #e11d48); }
        .team-badge.team-n { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .team-badge.team-o { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .team-badge.team-z { background: linear-gradient(135deg, #1e1e1e, #3d3d3d); }

        .team-badge-sm {
            width: 24px;
            height: 24px;
            font-size: 0.7rem;
            border-radius: 6px;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 260px;
            padding: 24px;
        }

        /* Top Header */
        .top-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            background: var(--bg-card);
            padding: 16px 24px;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }

        .search-box {
            position: relative;
            width: 320px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 16px 12px 44px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.95rem;
            font-family: 'Prompt', sans-serif;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .search-box i {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .notification-btn {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            border: none;
            background: var(--bg-main);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .notification-btn:hover {
            background: var(--primary);
            color: white;
        }

        .notification-btn .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            width: 18px;
            height: 18px;
            background: var(--danger);
            border-radius: 50%;
            font-size: 0.7rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            background: var(--bg-main);
            border-radius: 12px;
            cursor: pointer;
        }

        .admin-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .admin-info {
            text-align: left;
        }

        .admin-info .name {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .admin-info .role {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Stat Cards */
        .stat-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 24px;
            border-radius: 16px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stat-icon.blue {
            background: rgba(14, 165, 233, 0.1);
            color: var(--primary);
        }

        .stat-icon.green {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .stat-icon.orange {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .stat-icon.purple {
            background: rgba(168, 85, 247, 0.1);
            color: #a855f7;
        }

        .stat-info h3 {
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 1;
        }

        .stat-info p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .stat-trend {
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
        }

        .stat-trend.up {
            color: var(--success);
        }

        .stat-trend.down {
            color: var(--danger);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 24px;
        }

        /* Map Section */
        .map-section {
            background: var(--bg-card);
            border-radius: 16px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .section-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-header h2 {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-header h2 i {
            color: var(--primary);
        }

        .header-actions-group {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 18px;
            border-radius: 10px;
            font-size: 0.9rem;
            font-family: 'Prompt', sans-serif;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(14, 165, 233, 0.4);
        }

        .btn-outline {
            background: white;
            border: 2px solid var(--border);
            color: var(--text-primary);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        #map {
            height: 450px;
            width: 100%;
        }

        /* Checkins List */
        .checkins-section {
            background: var(--bg-card);
            border-radius: 16px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            max-height: 550px;
        }

        .checkins-list {
            flex: 1;
            overflow-y: auto;
            padding: 0 20px 20px;
        }

        .checkin-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 10px;
            background: var(--bg-main);
            transition: all 0.3s ease;
        }

        .checkin-item:hover {
            background: rgba(14, 165, 233, 0.05);
        }

        .checkin-avatar {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-light), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }

        .checkin-info {
            flex: 1;
        }

        .checkin-info .name {
            font-weight: 600;
            font-size: 0.95rem;
        }

        .checkin-info .location {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 2px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .checkin-info .time {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 4px;
        }

        .checkin-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .checkin-status.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .checkin-status.pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .checkin-status.inactive {
            background: rgba(100, 116, 139, 0.1);
            color: var(--text-secondary);
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 48px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #cbd5e1;
            border-radius: 26px;
            transition: 0.3s;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            border-radius: 50%;
            transition: 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch input:checked + .toggle-slider {
            background: linear-gradient(135deg, var(--primary), var(--accent));
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(22px);
        }

        /* Table View */
        .table-section {
            background: var(--bg-card);
            border-radius: 16px;
            box-shadow: var(--shadow);
            margin-top: 24px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 16px 20px;
            text-align: left;
        }

        .data-table th {
            background: var(--bg-main);
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table th:first-child {
            border-radius: 12px 0 0 0;
        }

        .data-table th:last-child {
            border-radius: 0 12px 0 0;
        }

        .data-table td {
            border-bottom: 1px solid var(--border);
            font-size: 0.95rem;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover td {
            background: rgba(14, 165, 233, 0.02);
        }

        .visibility-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* Filter Panel */
        .filter-panel {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            display: none;
        }

        .filter-panel.active {
            display: block;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 16px;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-group label {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .filter-group select,
        .filter-group input {
            padding: 10px 14px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 0.9rem;
            font-family: 'Prompt', sans-serif;
            background: white;
            transition: all 0.3s ease;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* Distance Panel */
        .distance-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 16px 20px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            min-width: 280px;
            display: none;
        }

        .distance-panel.active {
            display: block;
        }

        .distance-panel h4 {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .distance-panel h4 i {
            color: var(--primary);
        }

        .distance-info {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .distance-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary);
        }

        .distance-value span {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .btn-measure {
            background: linear-gradient(135deg, #8b5cf6, #a855f7);
            color: white;
        }

        .btn-measure.active {
            background: linear-gradient(135deg, var(--danger), #dc2626);
        }

        .btn-measure:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        /* Map container for distance panel positioning */
        .map-container {
            position: relative;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <h1><i class="fas fa-map-marker-alt"></i> Bait Check-In</h1>
            </div>
            <nav class="nav-menu">
                <div class="nav-item active" data-page="dashboard" onclick="showPage('dashboard')">
                    <i class="fas fa-chart-pie"></i>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" data-page="mapview" onclick="showPage('mapview')">
                    <i class="fas fa-map-location-dot"></i>
                    <span>Map View</span>
                </div>
                <div class="nav-item" data-page="checkins" onclick="showPage('checkins')">
                    <i class="fas fa-list-check"></i>
                    <span>Check-ins List</span>
                </div>
                <div class="nav-item" data-page="customers" onclick="showPage('customers')">
                    <i class="fas fa-users"></i>
                    <span>Customers</span>
                </div>
                <div class="nav-item" data-page="reports" onclick="showPage('reports')">
                    <i class="fas fa-chart-line"></i>
                    <span>Reports</span>
                </div>
                <div class="nav-item" data-page="settings" onclick="showPage('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Header -->
            <div class="top-header">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="ค้นหาลูกค้า, สถานที่...">
                </div>
                <div class="header-actions">
                    <button class="notification-btn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">5</span>
                    </button>
                    <div class="admin-profile">
                        <div class="admin-avatar">JS</div>
                        <div class="admin-info">
                            <div class="name">John Smith</div>
                            <div class="role">Administrator</div>
                        </div>
                        <i class="fas fa-chevron-down" style="color: var(--text-secondary); font-size: 0.8rem;"></i>
                    </div>
                </div>
            </div>

            <!-- Dashboard Page -->
            <div class="page-content" id="page-dashboard">
            <!-- Stat Cards -->
            <div class="stat-cards">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <i class="fas fa-location-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3>127</h3>
                        <p>Check-ins วันนี้</p>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i> +12% จากเมื่อวาน
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <i class="fas fa-map-pin"></i>
                    </div>
                    <div class="stat-info">
                        <h3>89</h3>
                        <p>Active Locations</p>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i> +5 ใหม่
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3>2,456</h3>
                        <p>Total Customers</p>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i> +23 สัปดาห์นี้
                        </div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon purple">
                        <i class="fas fa-chart-simple"></i>
                    </div>
                    <div class="stat-info">
                        <h3>95.2%</h3>
                        <p>อัตราความสำเร็จ</p>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i> +2.1%
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Grid -->
            <div class="content-grid">
                <!-- Filter Panel -->
                <div class="filter-panel" id="filterPanel">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label><i class="fas fa-users"></i> ทีม</label>
                            <select id="filterTeam">
                                <option value="all">ทั้งหมด</option>
                                <option value="A">Team A</option>
                                <option value="B">Team B</option>
                                <option value="C">Team C</option>
                                <option value="D">Team D</option>
                                <option value="E">Team E</option>
                                <option value="F">Team F</option>
                                <option value="G">Team G</option>
                                <option value="H">Team H</option>
                                <option value="I">Team I</option>
                                <option value="J">Team J</option>
                                <option value="K">Team K</option>
                                <option value="L">Team L</option>
                                <option value="M">Team M</option>
                                <option value="N">Team N</option>
                                <option value="O">Team O</option>
                                <option value="Z">Team Z</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-map-marker-alt"></i> เขต</label>
                            <select id="filterZone">
                                <option value="all">ทั้งหมด</option>
                                <option value="เขต 1">เขต 1</option>
                                <option value="เขต 2">เขต 2</option>
                                <option value="เขต 3">เขต 3</option>
                                <option value="เขต 4">เขต 4</option>
                                <option value="เขต 5">เขต 5</option>
                                <option value="เขต 6">เขต 6</option>
                                <option value="เขต 7">เขต 7</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-building"></i> สาขา</label>
                            <select id="filterBranch">
                                <option value="all">ทั้งหมด</option>
                                <optgroup label="เขต 1">
                                    <option>พุทธมณฑล</option>
                                    <option>นครปฐม</option>
                                    <option>หัวหิน</option>
                                    <option>พระราม 2</option>
                                </optgroup>
                                <optgroup label="เขต 2">
                                    <option>สาทร</option>
                                    <option>ปทุมวัน</option>
                                    <option>พระราม 4</option>
                                    <option>นนทบุรี</option>
                                </optgroup>
                                <optgroup label="เขต 3">
                                    <option>ปทุมธานี</option>
                                    <option>รามอินทรา</option>
                                    <option>อยุธยา</option>
                                </optgroup>
                                <optgroup label="เขต 4">
                                    <option>ลาดพร้าว</option>
                                    <option>พัฒนาการ</option>
                                    <option>สุวินทวงศ์</option>
                                    <option>ประชาชื่น</option>
                                </optgroup>
                                <optgroup label="เขต 5">
                                    <option>ปราจีนบุรี</option>
                                    <option>สมุทรปราการ</option>
                                    <option>พัทยา</option>
                                    <option>ระยอง</option>
                                </optgroup>
                                <optgroup label="เขต 6">
                                    <option>สุขุมวิท</option>
                                    <option>ปากน้ำ</option>
                                    <option>ชลบุรี</option>
                                </optgroup>
                                <optgroup label="เขต 7">
                                    <option>ปากช่อง</option>
                                    <option>สระบุรี</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label><i class="fas fa-calendar"></i> วันที่</label>
                            <input type="date" id="filterDate" value="2026-01-22">
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-primary" onclick="applyFilters()" style="width: 100%;">
                                <i class="fas fa-search"></i> ค้นหา
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Map Section -->
                <div class="map-section">
                    <div class="section-header">
                        <h2><i class="fas fa-map"></i> Location Map</h2>
                        <div class="header-actions-group">
                            <button class="btn btn-outline" onclick="toggleFilter()">
                                <i class="fas fa-filter"></i> Filter
                            </button>
                            <button class="btn btn-measure" id="measureBtn" onclick="toggleMeasure()">
                                <i class="fas fa-ruler"></i> วัดระยะ
                            </button>
                            <button class="btn btn-primary">
                                <i class="fas fa-expand"></i> Full Screen
                            </button>
                        </div>
                    </div>
                    <div class="map-container">
                        <div id="map"></div>
                        <!-- Distance Panel -->
                        <div class="distance-panel" id="distancePanel">
                            <h4><i class="fas fa-ruler"></i> วัดระยะทาง</h4>
                            <div class="distance-info" id="distanceInfo">คลิกจุดแรกบนแผนที่...</div>
                            <div class="distance-value" id="distanceValue">-- <span>กม.</span></div>
                        </div>
                    </div>
                </div>

                <!-- Recent Check-ins -->
                <div class="checkins-section">
                    <div class="section-header">
                        <h2><i class="fas fa-clock-rotate-left"></i> Recent Check-ins</h2>
                        <button class="btn btn-outline" style="padding: 8px 14px;">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                    <div class="checkins-list">
                        <div class="checkin-item">
                            <span class="team-badge team-badge-sm team-a">A</span>
                            <div class="checkin-avatar">อร</div>
                            <div class="checkin-info">
                                <div class="name">อรุณี วงศ์ประเสริฐ</div>
                                <div class="location"><i class="fas fa-location-dot"></i> Central World, กรุงเทพฯ</div>
                                <div class="time"><i class="far fa-clock"></i> 2 นาทีที่แล้ว</div>
                            </div>
                            <label class="toggle-switch" title="แสดงบนแผนที่">
                                <input type="checkbox" checked onchange="toggleMarker(0, this.checked)">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="checkin-item">
                            <span class="team-badge team-badge-sm team-b">B</span>
                            <div class="checkin-avatar">สม</div>
                            <div class="checkin-info">
                                <div class="name">สมชาย ใจดี</div>
                                <div class="location"><i class="fas fa-location-dot"></i> Siam Paragon, กรุงเทพฯ</div>
                                <div class="time"><i class="far fa-clock"></i> 15 นาทีที่แล้ว</div>
                            </div>
                            <label class="toggle-switch" title="แสดงบนแผนที่">
                                <input type="checkbox" checked onchange="toggleMarker(1, this.checked)">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="checkin-item">
                            <span class="team-badge team-badge-sm team-c">C</span>
                            <div class="checkin-avatar">วร</div>
                            <div class="checkin-info">
                                <div class="name">วรรณา สุขสันต์</div>
                                <div class="location"><i class="fas fa-location-dot"></i> EmQuartier, กรุงเทพฯ</div>
                                <div class="time"><i class="far fa-clock"></i> 32 นาทีที่แล้ว</div>
                            </div>
                            <label class="toggle-switch" title="แสดงบนแผนที่">
                                <input type="checkbox" checked onchange="toggleMarker(2, this.checked)">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="checkin-item">
                            <span class="team-badge team-badge-sm team-d">D</span>
                            <div class="checkin-avatar">ปร</div>
                            <div class="checkin-info">
                                <div class="name">ประเสริฐ รุ่งเรือง</div>
                                <div class="location"><i class="fas fa-location-dot"></i> Terminal 21, กรุงเทพฯ</div>
                                <div class="time"><i class="far fa-clock"></i> 1 ชั่วโมงที่แล้ว</div>
                            </div>
                            <label class="toggle-switch" title="แสดงบนแผนที่">
                                <input type="checkbox" onchange="toggleMarker(3, this.checked)">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="checkin-item">
                            <span class="team-badge team-badge-sm team-e">E</span>
                            <div class="checkin-avatar">มา</div>
                            <div class="checkin-info">
                                <div class="name">มานี มีศรี</div>
                                <div class="location"><i class="fas fa-location-dot"></i> ICONSIAM, กรุงเทพฯ</div>
                                <div class="time"><i class="far fa-clock"></i> 2 ชั่วโมงที่แล้ว</div>
                            </div>
                            <label class="toggle-switch" title="แสดงบนแผนที่">
                                <input type="checkbox" checked onchange="toggleMarker(4, this.checked)">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Full Data Table -->
            <div class="table-section">
                <div class="section-header">
                    <h2><i class="fas fa-table"></i> All Check-ins Data</h2>
                    <div class="header-actions-group">
                        <button class="btn btn-outline">
                            <i class="fas fa-filter"></i> Filter
                        </button>
                        <button class="btn btn-primary">
                            <i class="fas fa-file-export"></i> Export to Excel
                        </button>
                    </div>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ทีม</th>
                            <th>ลูกค้า</th>
                            <th>สถานที่</th>
                            <th>พิกัด</th>
                            <th>เวลา</th>
                            <th>สถานะ</th>
                            <th>แสดงบนแผนที่</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="team-badge team-a">A</span></td>
                            <td><strong>อรุณี วงศ์ประเสริฐ</strong></td>
                            <td>Central World, กรุงเทพฯ</td>
                            <td><code>13.7466, 100.5392</code></td>
                            <td>22 ม.ค. 2026, 10:01</td>
                            <td><span class="checkin-status active">Active</span></td>
                            <td>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td><span class="team-badge team-b">B</span></td>
                            <td><strong>สมชาย ใจดี</strong></td>
                            <td>Siam Paragon, กรุงเทพฯ</td>
                            <td><code>13.7460, 100.5347</code></td>
                            <td>22 ม.ค. 2026, 09:48</td>
                            <td><span class="checkin-status active">Active</span></td>
                            <td>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td><span class="team-badge team-c">C</span></td>
                            <td><strong>วรรณา สุขสันต์</strong></td>
                            <td>EmQuartier, กรุงเทพฯ</td>
                            <td><code>13.7311, 100.5696</code></td>
                            <td>22 ม.ค. 2026, 09:31</td>
                            <td><span class="checkin-status active">Active</span></td>
                            <td>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td><span class="team-badge team-d">D</span></td>
                            <td><strong>ประเสริฐ รุ่งเรือง</strong></td>
                            <td>Terminal 21, กรุงเทพฯ</td>
                            <td><code>13.7378, 100.5603</code></td>
                            <td>22 ม.ค. 2026, 09:03</td>
                            <td><span class="checkin-status pending">Pending</span></td>
                            <td>
                                <label class="toggle-switch">
                                    <input type="checkbox">
                                    <span class="toggle-slider"></span>
                                </label>
                            </td>
                        </tr>
                        <tr>
                            <td><span class="team-badge team-e">E</span></td>
                            <td><strong>มานี มีศรี</strong></td>
                            <td>ICONSIAM, กรุงเทพฯ</td>
                            <td><code>13.7268, 100.5100</code></td>
                            <td>22 ม.ค. 2026, 08:05</td>
                            <td><span class="checkin-status active">Active</span></td>
                            <td>
                                <label class="toggle-switch">
                                    <input type="checkbox" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div><!-- End Dashboard Page -->

            <!-- Map View Page -->
            <div class="page-content" id="page-mapview" style="display: none;">
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-map-location-dot" style="color: var(--primary);"></i> Map View
                </h2>
                <div class="map-section" style="height: calc(100vh - 200px);">
                    <div class="section-header">
                        <div class="header-actions-group">
                            <select style="padding: 10px 14px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                                <option>ทุกทีม</option>
                                <option>Team A</option>
                                <option>Team B</option>
                                <option>Team C</option>
                            </select>
                            <select style="padding: 10px 14px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                                <option>วันนี้</option>
                                <option>เมื่อวาน</option>
                                <option>7 วันที่แล้ว</option>
                                <option>30 วันที่แล้ว</option>
                            </select>
                            <button class="btn btn-primary"><i class="fas fa-search"></i> ค้นหา</button>
                        </div>
                    </div>
                    <div style="height: calc(100% - 80px); background: #e8f4f8; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                        <div style="text-align: center;">
                            <i class="fas fa-map" style="font-size: 4rem; margin-bottom: 16px; opacity: 0.5;"></i>
                            <p style="font-size: 1.1rem;">แผนที่แบบเต็มหน้าจอ</p>
                            <p style="font-size: 0.9rem; color: var(--text-light);">กรุณาเลือกตัวกรองและกดค้นหา</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Check-ins List Page -->
            <div class="page-content" id="page-checkins" style="display: none;">
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-list-check" style="color: var(--primary);"></i> Check-ins List
                </h2>
                <div class="table-section">
                    <div class="section-header">
                        <div style="display: flex; gap: 10px;">
                            <input type="text" placeholder="ค้นหาลูกค้า, เลขสัญญา..." style="padding: 10px 14px; border: 2px solid var(--border); border-radius: 10px; width: 300px; font-family: 'Prompt', sans-serif;">
                            <select style="padding: 10px 14px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                                <option>ทุกทีม</option>
                                <option>Team A</option>
                                <option>Team B</option>
                            </select>
                            <select style="padding: 10px 14px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                                <option>ทุกสถานะ</option>
                                <option>Active</option>
                                <option>Pending</option>
                            </select>
                        </div>
                        <div class="header-actions-group">
                            <button class="btn btn-outline"><i class="fas fa-filter"></i> Filter</button>
                            <button class="btn btn-primary"><i class="fas fa-file-export"></i> Export</button>
                        </div>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ทีม</th>
                                <th>ลูกค้า</th>
                                <th>เลขสัญญา</th>
                                <th>สาขา</th>
                                <th>เวลา</th>
                                <th>สถานะ</th>
                                <th>ภาพ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="team-badge team-a">A</span></td>
                                <td><strong>อรุณี วงศ์ประเสริฐ</strong></td>
                                <td><code>CT-12345</code></td>
                                <td>สาทร</td>
                                <td>22 ม.ค. 2026, 10:01</td>
                                <td><span class="checkin-status active">Active</span></td>
                                <td><i class="fas fa-image" style="color: var(--success);"></i></td>
                            </tr>
                            <tr>
                                <td><span class="team-badge team-b">B</span></td>
                                <td><strong>สมชาย ใจดี</strong></td>
                                <td><code>CT-67890</code></td>
                                <td>ปทุมวัน</td>
                                <td>22 ม.ค. 2026, 09:48</td>
                                <td><span class="checkin-status active">Active</span></td>
                                <td><i class="fas fa-image" style="color: var(--success);"></i></td>
                            </tr>
                            <tr>
                                <td><span class="team-badge team-c">C</span></td>
                                <td><strong>วรรณา สุขสันต์</strong></td>
                                <td><code>CT-11223</code></td>
                                <td>นนทบุรี</td>
                                <td>22 ม.ค. 2026, 09:31</td>
                                <td><span class="checkin-status active">Active</span></td>
                                <td><i class="fas fa-image" style="color: var(--success);"></i></td>
                            </tr>
                            <tr>
                                <td><span class="team-badge team-d">D</span></td>
                                <td><strong>ประเสริฐ รุ่งเรือง</strong></td>
                                <td><code>CT-44556</code></td>
                                <td>ลาดพร้าว</td>
                                <td>22 ม.ค. 2026, 09:03</td>
                                <td><span class="checkin-status pending">Pending</span></td>
                                <td><i class="fas fa-image" style="color: var(--warning);"></i></td>
                            </tr>
                        </tbody>
                    </table>
                    <div style="padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; border-top: 1px solid var(--border);">
                        <span style="color: var(--text-secondary); font-size: 0.9rem;">แสดง 1-4 จาก 127 รายการ</span>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-outline" style="padding: 8px 12px;"><i class="fas fa-chevron-left"></i></button>
                            <button class="btn btn-primary" style="padding: 8px 12px;">1</button>
                            <button class="btn btn-outline" style="padding: 8px 12px;">2</button>
                            <button class="btn btn-outline" style="padding: 8px 12px;">3</button>
                            <button class="btn btn-outline" style="padding: 8px 12px;"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customers Page -->
            <div class="page-content" id="page-customers" style="display: none;">
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-users" style="color: var(--primary);"></i> Customers
                </h2>
                <div class="stat-cards" style="margin-bottom: 24px;">
                    <div class="stat-card">
                        <div class="stat-icon blue"><i class="fas fa-users"></i></div>
                        <div class="stat-info">
                            <h3>2,456</h3>
                            <p>ลูกค้าทั้งหมด</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green"><i class="fas fa-user-check"></i></div>
                        <div class="stat-info">
                            <h3>1,892</h3>
                            <p>ลูกค้า Active</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange"><i class="fas fa-user-plus"></i></div>
                        <div class="stat-info">
                            <h3>45</h3>
                            <p>ลูกค้าใหม่เดือนนี้</p>
                        </div>
                    </div>
                </div>
                <div class="table-section">
                    <div class="section-header">
                        <input type="text" placeholder="ค้นหาลูกค้า..." style="padding: 10px 14px; border: 2px solid var(--border); border-radius: 10px; width: 300px; font-family: 'Prompt', sans-serif;">
                        <button class="btn btn-primary"><i class="fas fa-plus"></i> เพิ่มลูกค้า</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ลูกค้า</th>
                                <th>เลขสัญญา</th>
                                <th>สาขา</th>
                                <th>ติดตามล่าสุด</th>
                                <th>Check-ins</th>
                                <th>สถานะ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>อรุณี วงศ์ประเสริฐ</strong><br><small style="color: var(--text-secondary);">123/45 ซ.สุขุมวิท</small></td>
                                <td><code>CT-12345</code></td>
                                <td>สาทร</td>
                                <td>22 ม.ค. 2026</td>
                                <td>12</td>
                                <td><span class="checkin-status active">Active</span></td>
                            </tr>
                            <tr>
                                <td><strong>สมชาย ใจดี</strong><br><small style="color: var(--text-secondary);">789/12 ถ.พระราม 4</small></td>
                                <td><code>CT-67890</code></td>
                                <td>ปทุมวัน</td>
                                <td>21 ม.ค. 2026</td>
                                <td>8</td>
                                <td><span class="checkin-status active">Active</span></td>
                            </tr>
                            <tr>
                                <td><strong>วรรณา สุขสันต์</strong><br><small style="color: var(--text-secondary);">456 ถ.รัชดาภิเษก</small></td>
                                <td><code>CT-11223</code></td>
                                <td>นนทบุรี</td>
                                <td>20 ม.ค. 2026</td>
                                <td>15</td>
                                <td><span class="checkin-status active">Active</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Reports Page -->
            <div class="page-content" id="page-reports" style="display: none;">
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-chart-line" style="color: var(--primary);"></i> Reports
                </h2>
                <div class="stat-cards" style="margin-bottom: 24px;">
                    <div class="stat-card">
                        <div class="stat-icon blue"><i class="fas fa-calendar-check"></i></div>
                        <div class="stat-info">
                            <h3>3,456</h3>
                            <p>Check-ins เดือนนี้</p>
                            <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +15%</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green"><i class="fas fa-percentage"></i></div>
                        <div class="stat-info">
                            <h3>97.2%</h3>
                            <p>อัตราความสำเร็จ</p>
                            <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +2.1%</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange"><i class="fas fa-clock"></i></div>
                        <div class="stat-info">
                            <h3>45 นาที</h3>
                            <p>เวลาเฉลี่ยต่อสาย</p>
                            <div class="stat-trend down"><i class="fas fa-arrow-down"></i> -5 นาที</div>
                        </div>
                    </div>
                </div>
                <div class="content-grid" style="grid-template-columns: 1fr 1fr;">
                    <div class="table-section">
                        <div class="section-header"><h2><i class="fas fa-trophy"></i> Top Teams</h2></div>
                        <table class="data-table">
                            <thead><tr><th>ทีม</th><th>Check-ins</th><th>สำเร็จ</th></tr></thead>
                            <tbody>
                                <tr><td><span class="team-badge team-a">A</span></td><td>245</td><td>98.5%</td></tr>
                                <tr><td><span class="team-badge team-b">B</span></td><td>231</td><td>97.8%</td></tr>
                                <tr><td><span class="team-badge team-c">C</span></td><td>218</td><td>96.5%</td></tr>
                                <tr><td><span class="team-badge team-d">D</span></td><td>205</td><td>95.2%</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="table-section">
                        <div class="section-header"><h2><i class="fas fa-building"></i> Top Branches</h2></div>
                        <table class="data-table">
                            <thead><tr><th>สาขา</th><th>Check-ins</th><th>ลูกค้า</th></tr></thead>
                            <tbody>
                                <tr><td>สาทร</td><td>156</td><td>89</td></tr>
                                <tr><td>ปทุมวัน</td><td>142</td><td>76</td></tr>
                                <tr><td>นนทบุรี</td><td>128</td><td>65</td></tr>
                                <tr><td>ลาดพร้าว</td><td>115</td><td>58</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div class="page-content" id="page-settings" style="display: none;">
                <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-cog" style="color: var(--primary);"></i> Settings
                </h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                    <div class="table-section" style="padding: 24px;">
                        <h3 style="margin-bottom: 20px;"><i class="fas fa-user-cog"></i> บัญชีผู้ใช้</h3>
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <div>
                                <label style="display: block; font-weight: 500; margin-bottom: 6px;">ชื่อผู้ใช้</label>
                                <input type="text" value="John Smith" style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                            </div>
                            <div>
                                <label style="display: block; font-weight: 500; margin-bottom: 6px;">อีเมล</label>
                                <input type="email" value="john.smith@company.com" style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                            </div>
                            <div>
                                <label style="display: block; font-weight: 500; margin-bottom: 6px;">บทบาท</label>
                                <select style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; font-family: 'Prompt', sans-serif;">
                                    <option>Administrator</option>
                                    <option>Team Leader</option>
                                    <option>Staff</option>
                                </select>
                            </div>
                            <button class="btn btn-primary" style="margin-top: 10px;"><i class="fas fa-save"></i> บันทึก</button>
                        </div>
                    </div>
                    <div class="table-section" style="padding: 24px;">
                        <h3 style="margin-bottom: 20px;"><i class="fas fa-bell"></i> การแจ้งเตือน</h3>
                        <div style="display: flex; flex-direction: column; gap: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>แจ้งเตือน Check-in ใหม่</span>
                                <label class="toggle-switch"><input type="checkbox" checked><span class="toggle-slider"></span></label>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>แจ้งเตือนทางอีเมล</span>
                                <label class="toggle-switch"><input type="checkbox" checked><span class="toggle-slider"></span></label>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>รายงานประจำวัน</span>
                                <label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>แจ้งเตือนเมื่อมี Pending</span>
                                <label class="toggle-switch"><input type="checkbox" checked><span class="toggle-slider"></span></label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Leaflet Map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Initialize Map
        const map = L.map('map').setView([13.7400, 100.5400], 13);
        
        // Add tile layer (OpenStreetMap)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Custom marker icon
        const customIcon = L.divIcon({
            className: 'custom-marker',
            html: '<div style="background: linear-gradient(135deg, #0ea5e9, #06b6d4); width: 32px; height: 32px; border-radius: 50% 50% 50% 0; transform: rotate(-45deg); border: 3px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.3);"></div>',
            iconSize: [32, 32],
            iconAnchor: [16, 32]
        });

        // Sample check-in locations
        const locations = [
            { lat: 13.7466, lng: 100.5392, name: 'อรุณี วงศ์ประเสริฐ', place: 'Central World' },
            { lat: 13.7460, lng: 100.5347, name: 'สมชาย ใจดี', place: 'Siam Paragon' },
            { lat: 13.7311, lng: 100.5696, name: 'วรรณา สุขสันต์', place: 'EmQuartier' },
            { lat: 13.7378, lng: 100.5603, name: 'ประเสริฐ รุ่งเรือง', place: 'Terminal 21' },
            { lat: 13.7268, lng: 100.5100, name: 'มานี มีศรี', place: 'ICONSIAM' }
        ];

        // Store markers
        const markers = [];

        // Add markers
        locations.forEach((loc, index) => {
            const marker = L.marker([loc.lat, loc.lng], { icon: customIcon })
                .bindPopup(`
                    <div style="font-family: 'Prompt', sans-serif; padding: 5px;">
                        <strong style="font-size: 1rem;">${loc.name}</strong><br>
                        <span style="color: #64748b;"><i class="fas fa-location-dot"></i> ${loc.place}</span>
                    </div>
                `)
                .addTo(map);
            markers.push(marker);
        });

        // Initially hide marker at index 3 (matching unchecked toggle)
        map.removeLayer(markers[3]);

        // Toggle marker visibility
        function toggleMarker(index, visible) {
            if (visible) {
                markers[index].addTo(map);
            } else {
                map.removeLayer(markers[index]);
            }
        }

        // Filter Panel Toggle
        function toggleFilter() {
            const panel = document.getElementById('filterPanel');
            panel.classList.toggle('active');
        }

        // Page Navigation
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.style.display = 'none';
            });
            
            // Show selected page
            const selectedPage = document.getElementById('page-' + pageName);
            if (selectedPage) {
                selectedPage.style.display = 'block';
            }
            
            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.page === pageName) {
                    item.classList.add('active');
                }
            });
        }

        // Apply Filters (mockup - just shows alert)
        function applyFilters() {
            const team = document.getElementById('filterTeam').value;
            const zone = document.getElementById('filterZone').value;
            const branch = document.getElementById('filterBranch').value;
            const date = document.getElementById('filterDate').value;
            
            alert(`กำลังกรองข้อมูล:\n- ทีม: ${team}\n- เขต: ${zone}\n- สาขา: ${branch}\n- วันที่: ${date}`);
        }

        // Distance Measurement - Multi-point like Google Maps
        let measureMode = false;
        let measurePoints = [];
        let measureMarkers = [];
        let measureLine = null;
        let totalDistance = 0;

        function toggleMeasure() {
            measureMode = !measureMode;
            const btn = document.getElementById('measureBtn');
            const panel = document.getElementById('distancePanel');
            
            if (measureMode) {
                btn.classList.add('active');
                btn.innerHTML = '<i class="fas fa-times"></i> ยกเลิก';
                panel.classList.add('active');
                document.getElementById('distanceInfo').innerHTML = 'คลิกเพื่อเพิ่มจุด <button onclick="clearMeasurement()" style="background: #ef4444; color: white; border: none; padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; cursor: pointer; margin-left: 8px;"><i class="fas fa-trash"></i> ล้าง</button>';
                document.getElementById('distanceValue').innerHTML = '0.00 <span>กม.</span>';
                totalDistance = 0;
            } else {
                btn.classList.remove('active');
                btn.innerHTML = '<i class="fas fa-ruler"></i> วัดระยะ';
                panel.classList.remove('active');
                clearMeasurement();
            }
        }

        function clearMeasurement() {
            measurePoints = [];
            measureMarkers.forEach(m => map.removeLayer(m));
            measureMarkers = [];
            if (measureLine) {
                map.removeLayer(measureLine);
                measureLine = null;
            }
            totalDistance = 0;
            if (measureMode) {
                document.getElementById('distanceValue').innerHTML = '0.00 <span>กม.</span>';
            }
        }

        // Calculate distance using Haversine formula
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371; // Earth radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLng/2) * Math.sin(dLng/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // Calculate total distance for all points
        function calculateTotalDistance() {
            let total = 0;
            for (let i = 1; i < measurePoints.length; i++) {
                total += calculateDistance(
                    measurePoints[i-1].lat, measurePoints[i-1].lng,
                    measurePoints[i].lat, measurePoints[i].lng
                );
            }
            return total;
        }

        // Update the polyline with all points
        function updateMeasureLine() {
            if (measureLine) {
                map.removeLayer(measureLine);
            }
            if (measurePoints.length >= 2) {
                measureLine = L.polyline(measurePoints, {
                    color: '#ef4444',
                    weight: 3,
                    dashArray: '10, 10'
                }).addTo(map);
            }
        }

        // Map click handler for distance measurement
        map.on('click', function(e) {
            if (!measureMode) return;
            
            // Create marker with point number
            const pointNum = measurePoints.length + 1;
            const pointIcon = L.divIcon({
                className: 'measure-point',
                html: `<div style="background: #ef4444; width: 24px; height: 24px; border-radius: 50%; border: 3px solid white; box-shadow: 0 2px 6px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-size: 11px; font-weight: bold;">${pointNum}</div>`,
                iconSize: [24, 24],
                iconAnchor: [12, 12]
            });
            
            const marker = L.marker(e.latlng, { icon: pointIcon }).addTo(map);
            measureMarkers.push(marker);
            measurePoints.push(e.latlng);
            
            // Update the line
            updateMeasureLine();
            
            // Calculate and show total distance
            totalDistance = calculateTotalDistance();
            
            if (measurePoints.length === 1) {
                document.getElementById('distanceValue').innerHTML = '0.00 <span>กม.</span>';
            } else {
                // Show distance appropriately
                if (totalDistance < 1) {
                    // Show in meters if less than 1 km
                    document.getElementById('distanceValue').innerHTML = `${(totalDistance * 1000).toFixed(0)} <span>เมตร</span>`;
                } else {
                    document.getElementById('distanceValue').innerHTML = `${totalDistance.toFixed(2)} <span>กม.</span>`;
                }
            }
        });
    </script>
</body>
</html>
